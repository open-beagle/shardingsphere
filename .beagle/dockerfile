ARG BASE

FROM ${BASE}

ARG AUTHOR
ARG VERSION

LABEL maintainer=${AUTHOR} version=${VERSION}

ENV LOCAL_PATH /opt/shardingsphere-proxy

COPY shardingsphere-distribution/shardingsphere-proxy-distribution/target/apache-shardingsphere-5.1.2-shardingsphere-proxy-bin/ ${LOCAL_PATH}/

ARG MYSQL_CONNECTOR_VERSION

COPY .tmp/mysql-connector-java-$MYSQL_CONNECTOR_VERSION.jar /opt/shardingsphere-proxy/ext-lib/mysql-connector-java-$MYSQL_CONNECTOR_VERSION.jar
COPY .tmp/oscarJDBC8.jar /opt/shardingsphere-proxy/ext-lib/oscarJDBC8.jar
COPY .tmp/gbasedbtjdbc.jar /opt/shardingsphere-proxy/ext-lib/gbasedbtjdbc.jar
COPY .tmp/kingbase8-8.6.0.jar /opt/shardingsphere-proxy/ext-lib/kingbase8-8.6.0.jar

ENTRYPOINT ${LOCAL_PATH}/bin/start.sh ${PORT} && tail -f ${LOCAL_PATH}/logs/stdout.log